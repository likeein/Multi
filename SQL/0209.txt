<02/09 SQL>

/*각 부서별 급여의 합 출력, 단. 부서명과 해당 부서의 급여의 합 출력 */
SELECT D.DNAME, SUM(E.SAL)
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
GROUP BY D.DNAME;

/*문제1] NEW YORK과 DALLAS에 근무하는 사원들의 부서명과 평균 급여를 출력하는 쿼리를 작성하세요.*/
SELECT D.DNAME, AVG(E.SAL)
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO AND D.LOC IN ('NEW YORK', 'DALLAS')
GROUP BY D.DNAME;
/*문제2] 사원의 관리자보다 먼저 입사한 사원의 이름, 사원의 입사일, 관리자 이름, 관리자 입사일를 출력하는 쿼리를 작성하세요.*/
SELECT W.ENAME AS "사원이름", W.HIREDATE AS "사원 입사일", M.ENAME "관리자 이름", M.HIREDATE "관리자 입사일"
FROM EMP M, EMP W
WHERE M.EMPNO = W.MGR AND W.HIREDATE < M.HIREDATE

/*8장 연습 문제 - SQL 표준 문법 사용하지 않고 풀기*/
/*8 - 1*/
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO AND SAL > 2000
ORDER BY D.DEPTNO;
/*8 - 2*/
SELECT D.DEPTNO, D.DNAME, TRUNC(AVG(E.SAL)) AVG_SAL, MAX(E.SAL) MAX_SAL, MIN(E.SAL) MIN_SAL, COUNT(E.SAL) CNT
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
GROUP BY D.DEPTNO, D.DNAME;
/*8 - 3*/
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.JOB, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
ORDER BY D.DEPTNO;
/*8 - 4*/
SELECT D.DEPTNO, D.DNAME, W.EMPNO, W.ENAME, W.MGR, W.SAL, S.SEPTNO AS DEPTNO_1 , S.LOSAL, S.HISAL, S.GRADE, M.EMPNO AS MGR_EMPNO, M.ENAME AS MGR_ENAME
FROM EMP M, EMP W, DEPT D, SALGRADE S
WHERE M.EMPNO = W.MGR AND W.DEPTNO = D.DEPTNO AND W.SAL = S.SAL;